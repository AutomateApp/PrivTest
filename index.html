<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nagel-Group</title><style>
  body {
    background: linear-gradient(to bottom, #a5b3f5, #4c90f5, #2415fa);
    background-attachment: fixed;
    background-size: cover;
    margin: 0;
    padding: 0;
    font-family: sans-serif;
  }
</style>

<style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background-color: #f9f9f9;
    }
.logo-container {
  text-align: center;
  margin-bottom: 20px;
}
.logo {
  max-width: 150px;
  height: auto;
}

    .form-container {
      max-width: 500px;
      margin: auto;
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      box-sizing: border-box;
    }
    input[type="tel"] {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    input[type="text"],
    textarea {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
      box-sizing: border-box;
    } 
   input[type="time"] {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
      box-sizing: border-box;
      height: 40px;
    }
       input[type="file"] 
        {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
      box-sizing: border-box;
      height: 40px;
    }
	    input[type="number"],
    textarea {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
      box-sizing: border-box;
    }
select {
  width: 100%;
  padding: 10px;
  margin: 10px 0;
  border-radius: 5px;
  border: 1px solid #ccc;
  font-size: 16px;
  box-sizing: border-box;
  background-color: white;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}
    button {
      width: 100%;
      padding: 10px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
    .message-box {
      padding: 10px;
      margin-top: 15px;
      border-radius: 5px;
      font-size: 15px;
      animation: fadein 0.5s ease-in-out;
    }
    .error-box {
      background-color: #ffe5e5;
      color: #a94442;
      border: 1px solid #f5c6cb;
    }
    .success-box {
      background-color: #e6ffed;
      color: #2e7d32;
      border: 1px solid #c3e6cb;
    }
    @keyframes fadein {
      from { opacity: 0; transform: translateY(-5px); }
      to { opacity: 1; transform: translateY(0); }
    }
    #messageForm {
      display: none;
      margin-top: 20px;
    }
  </style>
<!--STYLE USZKODZENIA SVG-->
  <style>
    svg path, svg rect, svg polygon, svg circle, svg ellipse {
      cursor: pointer;
      transition: fill 0.2s;
    }

    .damaged {
      fill: red !important;
    }

    g.damaged ellipse,
    g.damaged rect,
    g.damaged path,
    g.damaged polygon,
    g.damaged circle {
      fill: red !important;
    }

    body {
      font-family: Arial, sans-serif;
      margin: 10px;
    }

    #damage-list {
      margin-top: 20px;
    }

    #damage-list li {
      margin-bottom: 5px;
      color: darkred;
      font-weight: bold;
    }

    .toggle-section {
      display: none;
    }

    .buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    @media (max-width: 600px) {
      .buttons {
        flex-direction: column;
      }
      .buttons button {
        width: 100%;
      }
    }

    svg {
      width: 100%;
      height: auto;
      max-width: 100%;
    }
  </style>
</head>
<body>
<div class="logo-container">
  <img src="https://backoffice-prod.nagel.nx3.cloud/auth/resources/tq5u7/login/nagel_backoffice_keycloak_theme/img/logo.png" alt="Logo" class="logo"><br>
  <label id="lokalizacja" style="display: none;">Pobieranie lokalizacji...</label>   <label id="czasStartu" style="display: none;"></label> 
  
</div> 
 <div class="form-container" id="codeForm" >
    <h2>Podaj kod SMS:</h2>
    <input type="number" id="smsCode" placeholder="Wpisz kod">
    <button onclick="verifyCode()">Wyślij</button>
    <div id="error" class="message-box error-box" style="display: none;"></div>
  </div> <!--WYBOR FORMULARZA-->
  <div class="form-container" id="WYBOR" style="display: none;">

  <table width="100%">
    <td width="50%">
<b><u>Typ zgłoszenia:</b></u>
      <select name="typ" id="typ" required>
        <option value="">-- Wybierz --</option>
        <option value="UszkodzeniaDIV">Uszkodzenia</option>
        <option value="Przepinka">Przepinka</option>
      </select>
    </td>
    <td width="50%">
      <label for="blokowanePole"><b><u>Numer naczepy:</u></b></label>
<input type="text" id="blokowanePole" value="11318536" readonly>
    </td>
  </table>
    </div><br>


  
<!--formularz przepinki -->   <div class="form-container" id="formPrzepinka" style="display: none;">



  <hr style="border: 0; border-top: 1px solid #ccc; margin: 10px 0;">

<table>
  <tr>
    <td>
      <label for="godzina">
        <b>Moja godzina</b> dojazdu na miejsce przepinki:
        <input type="time" id="godzina" name="godzina" required>
      </label>
    </td>
    <td>
              <button onclick="showInstruction()" style="background-color:  #007BFF; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
    Instrukcja
  </button>
    </td>
  </tr>
<tr>
    <td>
      <b>Mój oddział:</b>
      <select id="miejsce1" name="miejsce1" required>
        <option value="">-- Wybierz --</option>
        <option value="PL6">PL6</option>
      </select>
    </td>
    <td>
      <b>Drugi Oddział:</b>
      <select id="miejsce2" name="miejsce2" required>
        <option value="">-- Wybierz --</option>
        <option value="PL8">PL8</option>
      </select>
    </td>
  </tr>
</table>


<hr style="border: 1; border-top: 1px solid #181616; margin: 10px 0;">


<!--ZABEZPIECZENIE-->    
<table width="100%">
  <td width="40%"> <b>Zabezpieczenie naczepy</b> </td>
  <td width="30%">
<select id="zabezpieczenie" name="zabezpieczenie" required>
  <option value="">-- Wybierz --</option>
  <option value="Brak">Brak</option>
  <option value="Kłódka">Kłódka</option>
  <option value="Plomba">Plomba</option>
</select>
  </td>
  <td width="30%"><input type="text" id="NrPlomby" placeholder="Numer"></td>
</table>
<hr style="border: 0; border-top: 1px solid #ccc; margin: 10px 0;">

  <!--STAN PALIWA-->
<table width="100%">
  <tr>
    <td width="40%"> 
      <label for="suwakPaliwo"><b>Stan paliwa:</b></label>
    </td>
    <td width="10%">
      <button type="button" onclick="zmienWartoscPaliwo(-10)" style="background-color: azure;">⬇️</button>
    </td>
    <td width="40%" style="text-align: center;">
      <input
        type="range"
        id="suwakPaliwo"
        name="suwakPaliwo"
        min="0"
        max="100"
        value="50"
        step="10"
        oninput="wartoscPaliwo.value = this.value"
      >
      <br>
      <output name="wartoscPaliwo" id="wartoscPaliwo">50</output> %
    </td>
    <td width="10%">
      <button type="button" onclick="zmienWartoscPaliwo(10)" style="background-color: azure;">⬆️</button>
    </td>
  </tr>
</table>


<!--temperatura1-->
<table width="100%">
  <tr>
    <td width="40%">
      <label for="wartosc1"><b>Temp przestrzeni (1):</b></label>
    </td>

    <td width="10%">
      <button type="button" onclick="zmienWartosc(-0.1)" style="background-color: azure;">⬇️</button>
    </td>

    <td width="40%" style="text-align: center;">
      <input
        type="number"
        id="wartosc1"
        min="-25"
        max="30"
        step="0.1"
        value="5"
        onchange="aktualizujZInputu(this.value)"
        style="width: 90px; text-align: center;"
      > °C
    </td>

    <td width="10%">
      <button type="button" onclick="zmienWartosc(0.1)" style="background-color: azure;">⬆️</button>
    </td>
  </tr>
</table>

<!--temperatura2-->
<table width="100%">
  <tr>
    <td width="40%">
      <label for="wartosc2"><b>Temp przestrzeni (2):</b><br>
        <font size="1"><i>"Jeżeli dotyczy"</i></font>
      </label>
    </td>

    <td width="10%">
      <button type="button" onclick="zmienWartosc2(-0.1)" style="background-color: azure;">⬇️</button>
    </td>

    <td width="40%" style="text-align: center;">
      <input
        type="number"
        id="wartosc2"
        min="-25"
        max="30"
        step="0.1"
        value="5"
        onchange="aktualizujZInputu2(this.value)"
        style="width: 90px; text-align: center;"
      > °C
    </td>

    <td width="10%">
      <button type="button" onclick="zmienWartosc2(0.1)" style="background-color: azure;">⬆️</button>
    </td>
  </tr>
</table>



<hr style="border: 0; border-top: 1px solid #ccc; margin: 10px 0;">

<!--USZKODZENIA-->
	 <table width=100% name="Uszkodzenia">
    <td width=20%><b> Uszkodzenia:</b><br><button onclick="pokazDiv()">➕ Dodaj</button></td>
    <td width=80%><ul id="damage-list"></ul></td>
      </table>
<!--UWAGI-->
        <textarea
          name="message"
          id="messagePrzepinka"
          rows="4"
          cols="50"
          placeholder="Dodatkowe uwagi"
        ></textarea>
<!--ZALACZNIKI-->
   <label><b>Załączniki:</b> <input type="file" id="fileInputPrzepinka" multiple></label>  <br>

<BR>

      <button onclick="sendFormPrzepinka()">⮚ Wyślij</button>
    </div>

<!--USZKODZENIA-->
  <div class="form-container" id="formUszkodzeniaDIV" style="display: none; margin-top: 10px; padding: 10px; border: 1px solid #ccc;">
<table width="100%" style="text-align: center;">
  <td width="50%"> <button id="btnWstecz" onclick="ukryjDiv()"> << Wstecz</button> </td>
  <td width="50%"> <button onclick="resetDamage()">❌ Wyczyść</button> </td>
</table>


<table width="100%" style="text-align: center;">
  <td width="33%"> <button onclick="showSection('bok lewy')">Lewa</button> </td>
  <td width="33%"> <button onclick="showSection('bok prawy')">Prawa</button> </td>
  <td width="33%"> <button onclick="showSection('tyl-naczepy')">Tył</button> </td>

</table>
<br>
<i>*Zaznacz uszkodzenia</i>

<!-- WIDOKI -->
<div id="bok prawy" class="toggle-section">
     <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 304 171" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;">
            <g id="Reifen" transform="matrix(1,0,0,1,26.6402,82.24)">
                <ellipse id="Oval" cx="11.783" cy="11.676" rx="11.783" ry="11.676" style="fill:rgb(54,54,54);"/>
                <ellipse id="Oval1" serif:id="Oval" cx="11.783" cy="11.676" rx="6.66" ry="6.6" style="fill:rgb(111,111,111);"/>
                <ellipse id="Oval-Copy" cx="11.783" cy="11.676" rx="3.586" ry="3.554" style="fill:none;stroke:rgb(214,214,214);stroke-width:1px;"/>
            </g>
            <g id="Reifen-Copy" transform="matrix(1,0,0,1,53.2804,82.24)">
                <ellipse id="Oval2" serif:id="Oval" cx="11.783" cy="11.676" rx="11.783" ry="11.676" style="fill:rgb(54,54,54);"/>
                <ellipse id="Oval3" serif:id="Oval" cx="11.783" cy="11.676" rx="6.66" ry="6.6" style="fill:rgb(111,111,111);"/>
                <ellipse id="Oval-Copy1" serif:id="Oval-Copy" cx="11.783" cy="11.676" rx="3.586" ry="3.554" style="fill:none;stroke:rgb(214,214,214);stroke-width:1px;"/>
            </g>
            <g id="Reifen-Copy-2" transform="matrix(1,0,0,1,79.9206,82.24)">
                <ellipse id="Oval4" serif:id="Oval" cx="11.783" cy="11.676" rx="11.783" ry="11.676" style="fill:rgb(54,54,54);"/>
                <ellipse id="Oval5" serif:id="Oval" cx="11.783" cy="11.676" rx="6.66" ry="6.6" style="fill:rgb(111,111,111);"/>
                <ellipse id="Oval-Copy2" serif:id="Oval-Copy" cx="11.783" cy="11.676" rx="3.586" ry="3.554" style="fill:none;stroke:rgb(214,214,214);stroke-width:1px;"/>
            </g>
           
            <g id="Prawa noga" transform="matrix(-1,0,0,1,230.54,76.1482)">
                <rect id="Rectangle-Copy" x="1.025" y="0" width="4.098" height="24.367" style="fill:rgb(85,85,85);"/>
                <rect id="Rectangle-Copy-2" x="0" y="25.383" width="6.148" height="3.046" style="fill:rgb(85,85,85);"/>
            </g>
          
            <g id="Prawa ściana (Przód)">
               <rect id="Sciana-Przod" x="0.5" y="0.5" width="97" height="75.761" style="fill:white;stroke:black;stroke-width:1px;"/>
               </g>
             
              <g id="Prawa ściana (Środek)">
               <rect id="Sciana-Srodek" x="97.5" y="0.5" width="97" height="75.761" style="fill:white;stroke:black;stroke-width:1px;"/>
              </g>
              <g id="Prawa ściana (Tył)">
               <rect id="Sciana-Tyl" x="194.5" y="0.5" width="97" height="75.761" style="fill:white;stroke:black;stroke-width:1px;"/>
               </g>

                <rect id="Rectangle3" serif:id="Rectangle" x="0" y="70.946" width="292" height="5.815" style="fill:rgb(0,111,186);"/>
            
            <g id="Kosz paletowy (Prawa)" transform="matrix(-1,0,0,1,182.383,77.1635)">
                <g id="Group-Copy-2" transform="matrix(1,0,0,1,3.07387,0)">
                    <rect id="Rectangle-Copy2" serif:id="Rectangle-Copy" x="0" y="0" width="2.049" height="16.245" style="fill:rgb(85,85,85);"/>
                </g>
                <g id="Group-Copy-3" transform="matrix(1,0,0,1,54.305,0)">
                    <rect id="Rectangle-Copy3" serif:id="Rectangle-Copy" x="0" y="0" width="2.049" height="16.245" style="fill:rgb(85,85,85);"/>
                </g>
                <rect id="Rectangle4" serif:id="Rectangle" x="0" y="8.122" width="59.428" height="7.107" style="fill:none;stroke:rgb(85,85,85);stroke-width:2px;"/>
            </g>
            <path id="Agregat" d="M291.5,4L292.5,4C298.575,4 303.5,8.925 303.5,15L303.5,62C303.5,63.657 302.157,65 300.5,65L291.5,65L291.5,4Z" style="fill:rgb(216,216,216);stroke:black;stroke-width:1px;"/>
          
</svg>
</div>

<div id="bok lewy" class="toggle-section">
  <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 304 171" version="1.1"
     xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     xml:space="preserve"
     xmlns:serif="http://www.serif.com/"
     style="fill-rule:evenodd;clip-rule:evenodd;">

  <g transform="translate(304,0) scale(-1,1)"> <!-- ODBICIE LUSTRA -->

    <g id="1Reifen" transform="matrix(1,0,0,1,26.6402,82.24)">
      <ellipse id="Oval" cx="11.783" cy="11.676" rx="11.783" ry="11.676" style="fill:rgb(54,54,54);"/>
      <ellipse id="Oval1" serif:id="Oval" cx="11.783" cy="11.676" rx="6.66" ry="6.6" style="fill:rgb(111,111,111);"/>
      <ellipse id="Oval-Copy" cx="11.783" cy="11.676" rx="3.586" ry="3.554" style="fill:none;stroke:rgb(214,214,214);stroke-width:1px;"/>
    </g>

    <g id="1Reifen-Copy" transform="matrix(1,0,0,1,53.2804,82.24)">
      <ellipse id="Oval2" cx="11.783" cy="11.676" rx="11.783" ry="11.676" style="fill:rgb(54,54,54);"/>
      <ellipse id="Oval3" cx="11.783" cy="11.676" rx="6.66" ry="6.6" style="fill:rgb(111,111,111);"/>
      <ellipse id="Oval-Copy1" cx="11.783" cy="11.676" rx="3.586" ry="3.554" style="fill:none;stroke:rgb(214,214,214);stroke-width:1px;"/>
    </g>

    <g id="1Reifen-Copy-2" transform="matrix(1,0,0,1,79.9206,82.24)">
      <ellipse id="Oval4" cx="11.783" cy="11.676" rx="11.783" ry="11.676" style="fill:rgb(54,54,54);"/>
      <ellipse id="Oval5" cx="11.783" cy="11.676" rx="6.66" ry="6.6" style="fill:rgb(111,111,111);"/>
      <ellipse id="Oval-Copy2" cx="11.783" cy="11.676" rx="3.586" ry="3.554" style="fill:none;stroke:rgb(214,214,214);stroke-width:1px;"/>
    </g>

    <g id="Lewa noga" transform="matrix(-1,0,0,1,230.54,76.1482)">
      <rect id="Rectangle-Copy" x="1.025" y="0" width="4.098" height="24.367" style="fill:rgb(85,85,85);"/>
      <rect id="Rectangle-Copy-2" x="0" y="25.383" width="6.148" height="3.046" style="fill:rgb(85,85,85);"/>
    </g>

    <g id="Lewa ściana (Tył)">
      <rect id="Sciana-Przod" x="0.5" y="0.5" width="97" height="75.761" style="fill:white;stroke:black;stroke-width:1px;"/>
    </g>
    <g id="Lewa ściana (Środek)">
      <rect id="Sciana-Srodek" x="97.5" y="0.5" width="97" height="75.761" style="fill:white;stroke:black;stroke-width:1px;"/>
    </g>
    <g id="Lewa ściana (Przód)">
      <rect id="Sciana-Tyl" x="194.5" y="0.5" width="97" height="75.761" style="fill:white;stroke:black;stroke-width:1px;"/>
    </g>

    <rect id="Rectangle3" x="0" y="70.946" width="292" height="5.815" style="fill:rgb(0,111,186);"/>

    <g id="Kosz paletowy (Lewa)" transform="matrix(-1,0,0,1,182.383,77.1635)">
      <g id="Group-Copy-2" transform="matrix(1,0,0,1,3.07387,0)">
        <rect id="Rectangle-Copy2" x="0" y="0" width="2.049" height="16.245" style="fill:rgb(85,85,85);"/>
      </g>
      <g id="Group-Copy-3" transform="matrix(1,0,0,1,54.305,0)">
        <rect id="Rectangle-Copy3" x="0" y="0" width="2.049" height="16.245" style="fill:rgb(85,85,85);"/>
      </g>
      <rect id="Rectangle4" x="0" y="8.122" width="59.428" height="7.107" style="fill:none;stroke:rgb(85,85,85);stroke-width:2px;"/>
    </g>
<g>
    <path id="Agregat" d="M291.5,4L292.5,4C298.575,4 303.5,8.925 303.5,15L303.5,62C303.5,63.657 302.157,65 300.5,65L291.5,65L291.5,4Z" style="fill:rgb(216,216,216);stroke:black;stroke-width:1px;"/>

  </g> <!-- koniec lustrzanego odbicia -->

</svg>
</div>

<div id="tyl-naczepy" class="toggle-section">
  <svg width="300" height="250" viewBox="0 0 300 200" xmlns="http://www.w3.org/2000/svg"
       style="border:1px solid #ccc">
    <rect x="20" y="20" width="260" height="160" fill="white" stroke="black" stroke-width="2"/>
    <rect id="Drzwi Lewe" x="25" y="25" width="120" height="150" fill="#f0f0f0" stroke="black"/>
    <rect id="Drzwi Prawe" x="155" y="25" width="120" height="150" fill="#f0f0f0" stroke="black"/>
    <rect id="Zderzak" x="60" y="205" width="180" height="15" fill="gray"/>
    <rect id="Lampa Lewa" x="30" y="185" width="40 " height="15" fill="#f0f0f0" stroke="black"/>
    <rect id="Lampa Prawa" x="230" y="185" width="40 " height="15" fill="#f0f0f0" stroke="black"/>
  </svg>
</div>
<!--formularz USTERKA -->   <div class="form-container" id="divUszkodzeniaDIV" style="display: none;">
	<input type="hidden" id="typ" value="Usterka">
	
	  
	
<b> Uwagi:</b> <br> 
	 <label>
        <textarea
          name="message"
          id="message"
          rows="4"
          cols="50"
          placeholder="Opis..."
        ></textarea></label>

   <label><b>Załączniki:</b> <input type="file" id="fileInput" multiple></label>  

<BR>

      <button onclick="sendFormusterka()">⮚ Wyślij</button>
    </div> 

  </div>

<!-- Komunikat PO PRZESŁANIU FORMULARZA -->
  <div id="success" class="form-container" style="display: none;">✅ Formularz został wysłany.</div>

<!-- Instrukcja dla użytkownika -->
<div id="userInstruction" style="position: fixed; top: 10%; left: 50%; transform: translateX(-50%); background-color: #ffffff; color: #000; padding: 20px; font-size: 14px; border: 1px solid #ccc; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.3); width: 90%; max-width: 500px; z-index: 1001; display: none;">
  <h3>Instrukcja</h3>
  <p>
    <b>Moja godzina</b> - Godzina o której dojechałeś na miejscie przepinki <br>
    <b>Mój oddział</b> - Oddział z którego wyjechałeś <br>
    <b>Drugi oddział</b> - Oddział z którym się przepinasz
  </p>
  
  <div style="text-align: right; margin-top: 10px;">
    <button onclick="hideInstruction()" style="background-color: #007BFF; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">Rozumiem</button>
  </div>
</div>



<!--kod sms -->  <script>
    let codeExpirationTime = new Date('2025-07-12T22:18:08.4071180Z').getTime();

    function verifyCode() {
      const code = document.getElementById('smsCode').value.trim();
      const errorDiv = document.getElementById('error');
      const successDiv = document.getElementById('success');
      const formDiv = document.getElementById('WYBOR');
      const codeForm = document.getElementById('codeForm');

      errorDiv.style.display = 'none';
      successDiv.style.display = 'none';

      if (Date.now() > codeExpirationTime) {
        errorDiv.textContent = '❌ Kod wygasł. Poproś o nowy kod.';
        errorDiv.style.display = 'block';
        formDiv.style.display = 'none';
        return;
      }

      if (code === '123') {
        codeForm.style.display = 'none';
        formDiv.style.display = 'block';

        const remainingTime = codeExpirationTime - Date.now();
        if (remainingTime < 0) {
          setTimeout(() => {
            successDiv.textContent = '⏱️ Czas na wysłanie wiadomości minął.';
            successDiv.style.display = 'block';
          }, remainingTime);
        }
      } else {
        errorDiv.textContent = '❌ Nieprawidłowy kod.';
        errorDiv.style.display = 'block';
        formDiv.style.display = 'none';
      }
    }

    async function sendForm() {
      const files = document.getElementById("fileInput").files;
      const attachments = [];

      for (const file of files) {
        const base64 = await toBase64(file);
        attachments.push({
          filename: file.name,
          filecontent: base64.split(',')[1]
        });
      }

      const payload = {
        typ: document.getElementById("typ").value,
        message: document.getElementById("message").value,
        naczepa: document.getElementById("naczepa").value,
        phone: document.getElementById("phone").value,
        rodzaj: document.getElementById("rodzaj").value,
        attachments: attachments
      };

      const response = await fetch("https://prod-37.northeurope.logic.azure.com:443/workflows/12ebcefa66e347ada446eb08dac40885/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=CwiwENOs6qwIhWQ7Dwml2BlOKzUg2naFcXlZNXZzPSs", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      const successDiv = document.getElementById("success");
      const messageForm = document.getElementById("messageForm");

      if (response.ok) {
        codeExpirationTime = 0; // kod wygasa po wysłaniu
        messageForm.style.display = "none";
        successDiv.textContent = "ok";
        successDiv.style.display = "block";
      } else {
        successDiv.textContent = "❌ Błąd przy wysyłaniu zgłoszenia.";
        successDiv.style.display = "block";
      }
    }

  </script>
<!--show form -->    <script>
  function showFormForType(type) {
    // Lista identyfikatorów formularzy dla każdej opcji
    const formIds = ["Usterka", "Przepinka", "UszkodzeniaDIV"];

    // Ukryj wszystkie formularze
    formIds.forEach(id => {
      const form = document.getElementById("form" + id);
      if (form) {
        form.style.display = "none";
      }
    });

    // Pokaż wybrany formularz
    if (type && document.getElementById("form" + type)) {
      document.getElementById("form" + type).style.display = "block";
    }
  }

  // Automatyczne podłączenie po załadowaniu strony
  document.addEventListener("DOMContentLoaded", function () {
    const select = document.getElementById("typ");
    if (select) {
      select.addEventListener("change", function () {
        showFormForType(this.value);
      });
    }
  });
</script>
<!--Lokalizacja --> <script>
fetch("https://ipapi.co/json/")
  .then(res => res.json())
  .then(data => {
    const info = `${data.city}, ${data.country_name} `;
    document.getElementById("lokalizacja").textContent = info;
  })
  .catch(() => {
    document.getElementById("lokalizacja").textContent = "Nie udało się pobrać lokalizacji z IP.";
  });
   </script>
<!--Data i Czas --> <script>
window.addEventListener("DOMContentLoaded", () => {
  const teraz = new Date();

  const dzien = teraz.getDate().toString().padStart(2, '0');
  const miesiac = (teraz.getMonth() + 1).toString().padStart(2, '0'); // miesiące 0-11
  const rok = teraz.getFullYear();

  const godzina = teraz.getHours().toString().padStart(2, '0');
  const minuta = teraz.getMinutes().toString().padStart(2, '0');
  const sekunda = teraz.getSeconds().toString().padStart(2, '0');

  const czas = `${dzien}.${miesiac}.${rok} ${godzina}:${minuta}:${sekunda}`;

  document.getElementById("czasStartu").textContent = "" + czas;
});

 </script>
 <!--send form PRZEPINKA --> <script>
 async function sendFormPrzepinka() {

  // Numer plomby
  const numerPlomby = document.getElementById("NrPlomby").value.trim();
  if (numerPlomby === "") {
    alert("❗ Podaj numer plomby.");
   return;
  }

// Miejsce przepinki
const miejsce = document.getElementById("miejsce").value;
if (!miejsce) {
  alert("❗ Wybierz miejsce przepinki .");
  return;
}

 
const zabezpieczenie = document.getElementById("zabezpieczenie").value;
if (!zabezpieczenie) {
  alert("❗ Wybierz zabezpieczenie .");
  return;
}

const temperatura = document.getElementById("wartosc1").textContent;
const message = document.getElementById("messagePrzepinka").value.trim();

const godzinaDojazdu = document.getElementById("godzina").value;
if (!godzinaDojazdu) {
  alert("❗ Podaj godzinę dojazdu.");
  return;
}


const paliwo = document.getElementById("wartoscPaliwo").textContent;
const uszkodzenia = document.getElementById("damage-list").textContent;
   // Pobieranie pozostałych danych
  const lokalizacja = document.getElementById("lokalizacja").textContent;
  const czasStartu = document.getElementById("czasStartu").textContent;
    
  // Przetwarzanie załączników
  const files = document.getElementById("fileInputPrzepinka").files;
  const attachments = [];

  for (const file of files) {
    const base64 = await toBase64(file);
    attachments.push({
      filename: file.name,
      filecontent: base64.split(',')[1]
    });
  }


  // Tworzenie danych do wysyłki
  const payload = {
    lokalizacja,
    czasStartu,
    miejsce,
    godzinaDojazdu,
    zabezpieczenie,
    numerPlomby,
    naczepa: "11318536",
    phone:"0048506597418",
    paliwo,
    temperatura,
    uszkodzenia,
    message,
    attachments,
    rodzaj: "PRZEPINKA",
	typ: "Przepinka"
  };

  // Wysyłka
  const response = await fetch("https://prod-37.northeurope.logic.azure.com:443/workflows/12ebcefa66e347ada446eb08dac40885/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=CwiwENOs6qwIhWQ7Dwml2BlOKzUg2naFcXlZNXZzPSs", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  if (response.ok) {
    
	// Ukryj obecny formularz PRZEPINKA
  document.getElementById("formPrzepinka").style.display = "none";
  document.getElementById("WYBOR").style.display = "none";
   
  // Pokaż kolejny formularz, np. USTERKA
  document.getElementById("success").style.display = "block";
	
  } else {
    alert("❌ Błąd podczas wysyłania formularza.");
  }
}

// Konwersja pliku na base64
function toBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => resolve(reader.result);
    reader.onerror = error => reject(error);
  });
}


  </script>
<!--send form USTERKI --> <script>
 async function sendFormusterka() {
  const lokalizacja = document.getElementById("lokalizacja").textContent;
  const czasStartu = document.getElementById("czasStartu").textContent;
  const message = document.getElementById("message").value.trim();
  const files = document.getElementById("fileInput").files;
const uszkodzenia = document.getElementById("damage-list").textContent;

  // Przetwarzanie załączników
  const attachments = [];
  for (const file of files) {
    const base64 = await toBase64(file);
    attachments.push({
      filename: file.name,
      filecontent: base64.split(',')[1]
    });
  }

  const payload = {
    lokalizacja,
    czasStartu,
	naczepa: "11318536",
    typ: "Usterka",
    message,
    uszkodzenia,
	phone: "0048506597418",
    attachments,
    rodzaj: "USTERKA"
  };

  const response = await fetch("https://prod-37.northeurope.logic.azure.com:443/workflows/12ebcefa66e347ada446eb08dac40885/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=CwiwENOs6qwIhWQ7Dwml2BlOKzUg2naFcXlZNXZzPSs", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  if (response.ok) {
    	// Ukryj obecny formularz 
  document.getElementById("formUszkodzeniaDIV").style.display = "none";
  document.getElementById("divUszkodzeniaDIV").style.display = "none";
  document.getElementById("WYBOR").style.display = "none";
  
  // Pokaż kolejny formularz, np. 
  document.getElementById("success").style.display = "block";
	
  } else {
    alert("❌ Błąd podczas wysyłania formularza.");
  }
}

// Pomocnicza funkcja do konwersji plików
function toBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => resolve(reader.result);
    reader.onerror = error => reject(error);
  });
}




  </script>
<!--SUWAK TEMP--> <script>
  function zmienWartosc(kierunek) {
    const pole = document.getElementById("wartosc1");
    let nowa = parseFloat(pole.value) + kierunek;
    nowa = Math.min(Math.max(nowa, parseFloat(pole.min)), parseFloat(pole.max));
    pole.value = parseFloat(nowa.toFixed(1));
  }

  function aktualizujZInputu(wartosc) {
    const pole = document.getElementById("wartosc1");
    let nowa = Math.min(Math.max(parseFloat(wartosc), parseFloat(pole.min)), parseFloat(pole.max));
    pole.value = parseFloat(nowa.toFixed(1));
  }
</script>

<!--SUWAK TEMP2--> <script>
  function zmienWartosc2(kierunek) {
    const pole = document.getElementById("wartosc2");
    let nowa = parseFloat(pole.value) + kierunek;
    nowa = Math.min(Math.max(nowa, parseFloat(pole.min)), parseFloat(pole.max));
    nowa = parseFloat(nowa.toFixed(1));
    pole.value = nowa;
  }

  function aktualizujZInputu2(wartosc) {
    const pole = document.getElementById("wartosc2");
    let nowa = Math.min(Math.max(parseFloat(wartosc), parseFloat(pole.min)), parseFloat(pole.max));
    pole.value = parseFloat(nowa.toFixed(1));
  }
</script>

<!--SUWAK PALIWO--> <script>
  function zmienWartoscPaliwo(kierunek) {
    const suwak = document.getElementById("suwakPaliwo");
    let nowa = parseFloat(suwak.value) + kierunek;
    nowa = Math.min(Math.max(nowa, parseFloat(suwak.min)), parseFloat(suwak.max));
    nowa = parseFloat(nowa.toFixed(1)); // zaokrąglenie do 1 miejsca po przecinku
    suwak.value = nowa;
    document.getElementById("wartoscPaliwo").value = nowa;
  }
</script>

<!--POKAZ/UKRYJ USZKODZENIA-->
<script>
  function pokazDiv() {
    document.getElementById("formUszkodzeniaDIV").style.display = "block";
    document.getElementById("formPrzepinka").style.display = "none";
  }

  function ukryjDiv() {
    document.getElementById("formUszkodzeniaDIV").style.display = "none";
    document.getElementById("formPrzepinka").style.display = "block";
  }
</script>

<!--ZAZNACZ USZKODZENIA-->
<script>
  function showSection(id) {
    document.querySelectorAll('.toggle-section').forEach(div => {
      div.style.display = 'none';
    });
    document.getElementById(id).style.display = 'block';
  }

  document.addEventListener('DOMContentLoaded', () => {
    showSection('bok lewy');
    const list = document.getElementById('damage-list');

    const groupMappings = {
      kolaP: {
        ids: ['Reifen', 'Reifen-Copy', 'Reifen-Copy-2'],
        label: 'Prawe koło'
      },
      kolaL: {
        ids: ['1Reifen', '1Reifen-Copy', '1Reifen-Copy-2'],
        label: 'Lewe koło'
      },
      kosz: {
        ids: ['Kosz paletowy'],
        label: 'Kosz paletowy'
      }
    };

    const toggleGroup = (groupKey) => {
      const { ids, label } = groupMappings[groupKey];
      const anyDamaged = ids.some(id => document.getElementById(id)?.classList.contains('damaged'));

      ids.forEach(id => {
        const g = document.getElementById(id);
        if (g) g.classList.toggle('damaged', !anyDamaged);
      });

      const existing = list.querySelector(`[data-id="${groupKey}"]`);
      if (anyDamaged) {
        if (existing) existing.remove();
      } else {
        if (!existing) {
          const li = document.createElement('li');
          li.textContent = `${label}`;
          li.dataset.id = groupKey;
          list.appendChild(li);
        }
      }
    };

    document.querySelectorAll('svg').forEach(svgRoot => {
      svgRoot.querySelectorAll('path, rect, polygon, circle, ellipse').forEach(el => {
        el.addEventListener('click', () => {
          const group = el.closest('g');
          const groupId = group?.id || '';

          for (const [key, { ids }] of Object.entries(groupMappings)) {
            if (ids.includes(groupId)) {
              toggleGroup(key);
              return;
            }
          }

          const target = group || el;
          const partId = target.id || el.id || '';
          const isDamaged = target.classList.toggle('damaged');

          const existing = list.querySelector(`[data-id="${partId}"]`);
          if (isDamaged) {
            if (!existing) {
              const li = document.createElement('li');
              li.textContent = ` ${partId},`;
              li.dataset.id = partId;
              list.appendChild(li);
            }
          } else {
            if (existing) existing.remove();
          }
        });
      });
    });
  });
</script>

<!--RESETUJ USZKODZENIA-->
<script>
    function resetDamage() {
    document.querySelectorAll('.damaged').forEach(el => el.classList.remove('damaged'));
    document.getElementById('damage-list').innerHTML = '';
  }
</script>

<script>
document.getElementById("typ").addEventListener("change", function () {
  const btn = document.getElementById("btnWstecz");
  const div = document.getElementById("divUszkodzeniaDIV");
  const wybranyTyp = this.value;

  if (wybranyTyp === "Przepinka") {
    btn.style.display = "inline-block";
    div.style.display = "none";
  } else {
    btn.style.display = "none";
    div.style.display = "block";
  }
});
</script>

<!--POKAZ INSTRUKCJE-->
<script>
  function showInstruction() {
    document.getElementById('userInstruction').style.display = 'block';
  }

  function hideInstruction() {
    document.getElementById('userInstruction').style.display = 'none';
  }
</script>


</body>
</html>
